<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="562px" preserveAspectRatio="none" style="width:819px;height:562px;background:#FFFFFF;" version="1.1" viewBox="0 0 819 562" width="819px" zoomAndPan="magnify"><defs><filter height="300%" id="f1x9bdlx09vfg5" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="543.7461" style="stroke:#A80036;stroke-width:1.0;" width="189.5" x="441" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="494.25" y="18.5684">Bob's device</text><rect fill="#FFFFFF" filter="url(#f1x9bdlx09vfg5)" height="35.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="301" y="495.4355"/><rect fill="#FFFFFF" filter="url(#f1x9bdlx09vfg5)" height="104.7539" style="stroke:#A80036;stroke-width:1.0;" width="10" x="600" y="197.8184"/><rect fill="#FFFFFF" filter="url(#f1x9bdlx09vfg5)" height="132.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="600" y="333.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="306" x2="306" y1="87.7988" y2="555.7461"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="461" x2="461" y1="87.7988" y2="555.7461"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="604.5" x2="604.5" y1="87.7988" y2="555.7461"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="763" x2="763" y1="87.7988" y2="555.7461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="261" y="84.8457">Alice's clone</text><path d="M288,35.3105 C288,25.3105 306,25.3105 306,25.3105 C306,25.3105 324,25.3105 324,35.3105 L324,61.3105 C324,71.3105 306,71.3105 306,71.3105 C306,71.3105 288,71.3105 288,61.3105 L288,35.3105 " fill="#FEFECE" filter="url(#f1x9bdlx09vfg5)" style="stroke:#000000;stroke-width:1.5;"/><path d="M288,35.3105 C288,45.3105 306,45.3105 306,45.3105 C306,45.3105 324,45.3105 324,35.3105 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="445" y="84.8457">app</text><ellipse cx="461" cy="55.3105" fill="#FEFECE" filter="url(#f1x9bdlx09vfg5)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="457,43.3105,463,38.3105,461,43.3105,463,48.3105,457,43.3105" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="583.5" y="84.8457">clone</text><path d="M587,35.3105 C587,25.3105 605,25.3105 605,25.3105 C605,25.3105 623,25.3105 623,35.3105 L623,61.3105 C623,71.3105 605,71.3105 605,71.3105 C605,71.3105 587,71.3105 587,61.3105 L587,35.3105 " fill="#FEFECE" filter="url(#f1x9bdlx09vfg5)" style="stroke:#000000;stroke-width:1.5;"/><path d="M587,35.3105 C587,45.3105 605,45.3105 605,45.3105 C605,45.3105 623,45.3105 623,35.3105 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#f1x9bdlx09vfg5)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="88" x="717" y="52.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="724" y="72.8457">messaging</text><rect fill="#FFFFFF" filter="url(#f1x9bdlx09vfg5)" height="35.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="301" y="495.4355"/><rect fill="#FFFFFF" filter="url(#f1x9bdlx09vfg5)" height="104.7539" style="stroke:#A80036;stroke-width:1.0;" width="10" x="600" y="197.8184"/><rect fill="#FFFFFF" filter="url(#f1x9bdlx09vfg5)" height="132.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="600" y="333.8828"/><polygon fill="#A80036" points="751,139.8086,761,143.8086,751,147.8086,755,143.8086" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="306" x2="757" y1="143.8086" y2="143.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="313" y="139.0664">Op3 ≪agree≫</text><rect fill="#FBFB77" filter="url(#f1x9bdlx09vfg5)" height="68" style="stroke:#A80036;stroke-width:1.0;" width="296" x="5" y="102.7988"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="48" x="9" y="118.8657">INSERT</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="192" x="25" y="133.9985">Bob mld:publicKey 5678 .</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="272" x="25" y="149.1313">Bob mld:hasAccess { "@id": "?" } .</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253" x="9" y="164.7656">(gives Bob write permission to anything)</text><polygon fill="#A80036" points="621,193.8184,611,197.8184,621,201.8184,617,197.8184" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="615" x2="762" y1="197.8184" y2="197.8184"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="627" y="193.0762">Op3</text><line style="stroke:#A80036;stroke-width:1.0;" x1="610" x2="652" y1="227.1289" y2="227.1289"/><line style="stroke:#A80036;stroke-width:1.0;" x1="652" x2="652" y1="227.1289" y2="240.1289"/><line style="stroke:#A80036;stroke-width:1.0;" x1="611" x2="652" y1="240.1289" y2="240.1289"/><polygon fill="#A80036" points="621,236.1289,611,240.1289,621,244.1289,617,240.1289" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="617" y="222.3867">ACL constraint apply</text><rect fill="#FBFB77" filter="url(#f1x9bdlx09vfg5)" height="23" style="stroke:#A80036;stroke-width:1.0;" width="280" x="465" y="253.1289"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="272" x="469" y="269.1958">Bob mld:hasAccess { "@id": "?" } .</text><polygon fill="#A80036" points="472,298.5723,462,302.5723,472,306.5723,468,302.5723" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="466" x2="604" y1="302.5723" y2="302.5723"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="478" y="297.8301">Op3 ≪update≫</text><polygon fill="#A80036" points="588,329.8828,598,333.8828,588,337.8828,592,333.8828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="461" x2="594" y1="333.8828" y2="333.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="468" y="329.1406">Op4 ≪transaction≫</text><rect fill="#FBFB77" filter="url(#f1x9bdlx09vfg5)" height="23" style="stroke:#A80036;stroke-width:1.0;" width="123" x="333" y="315.5723"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="48" x="337" y="331.8169">INSERT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="389" y="332.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="63" x="389" y="332.1406">[anything]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="610" x2="652" y1="365.1934" y2="365.1934"/><line style="stroke:#A80036;stroke-width:1.0;" x1="652" x2="652" y1="365.1934" y2="378.1934"/><line style="stroke:#A80036;stroke-width:1.0;" x1="611" x2="652" y1="378.1934" y2="378.1934"/><polygon fill="#A80036" points="621,374.1934,611,378.1934,621,382.1934,617,378.1934" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="617" y="360.4512">ACL constraint check</text><polygon fill="#A80036" points="751,403.5039,761,407.5039,751,411.5039,755,407.5039" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="610" x2="757" y1="407.5039" y2="407.5039"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="617" y="402.7617">Op4</text><polygon fill="#A80036" points="472,432.8145,462,436.8145,472,440.8145,468,436.8145" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="466" x2="599" y1="436.8145" y2="436.8145"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="45" x="478" y="432.0723">resolve</text><polygon fill="#A80036" points="472,462.125,462,466.125,472,470.125,468,466.125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="466" x2="604" y1="466.125" y2="466.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="478" y="461.3828">Op4 ≪update≫</text><polygon fill="#A80036" points="322,491.4355,312,495.4355,322,499.4355,318,495.4355" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="316" x2="762" y1="495.4355" y2="495.4355"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="328" y="490.6934">Op4</text><line style="stroke:#A80036;stroke-width:1.0;" x1="311" x2="353" y1="529.7461" y2="529.7461"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353" x2="353" y1="529.7461" y2="542.7461"/><line style="stroke:#A80036;stroke-width:1.0;" x1="306" x2="353" y1="542.7461" y2="542.7461"/><polygon fill="#A80036" points="316,538.7461,306,542.7461,316,546.7461,312,542.7461" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="318" y="525.0039">ACL constraint apply</text><!--MD5=[c585dbdb661197f3aa277c2034188c17]
@startuml
'https://plantuml.com/sequence-diagram
hide footbox

database "Alice's clone" as genesis
box Bob's device
control "app" as proc2
database "clone" as clone2
end box

genesis -> messaging: Op3 ≪agree≫
rnote left
<code>
INSERT
  Bob mld:publicKey 5678 .
  Bob mld:hasAccess { "@id": "?" } .
</code>
(gives Bob write permission to anything)
end note

messaging -> clone2 ++: Op3
clone2 -> clone2: ACL constraint apply
rnote over clone2: ""Bob mld:hasAccess { "@id": "?" } .""
clone2 -> proc2 - -: Op3 ≪update≫

proc2 -> clone2 ++: Op4 ≪transaction≫
rnote left: ""INSERT"" //[anything]//

clone2 -> clone2: ACL constraint check

clone2 -> messaging: Op4
clone2 - -> proc2: //resolve//
clone2 -> proc2 - -: Op4 ≪update≫
messaging -> genesis ++: Op4
genesis -> genesis - -: ACL constraint apply

@enduml

@startuml
hide footbox

database "Alice's clone" as genesis
box Bob's device
control "app" as proc2
database "clone" as clone2
end box

genesis -> messaging: Op3 ≪agree≫
rnote left
<code>
INSERT
  Bob mld:publicKey 5678 .
  Bob mld:hasAccess { "@id": "?" } .
</code>
(gives Bob write permission to anything)
end note

messaging -> clone2 ++: Op3
clone2 -> clone2: ACL constraint apply
rnote over clone2: ""Bob mld:hasAccess { "@id": "?" } .""
clone2 -> proc2 - -: Op3 ≪update≫

proc2 -> clone2 ++: Op4 ≪transaction≫
rnote left: ""INSERT"" //[anything]//

clone2 -> clone2: ACL constraint check

clone2 -> messaging: Op4
clone2 - -> proc2: //resolve//
clone2 -> proc2 - -: Op4 ≪update≫
messaging -> genesis ++: Op4
genesis -> genesis - -: ACL constraint apply

@enduml

PlantUML version 1.2021.10(Mon Aug 30 14:43:48 BST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>